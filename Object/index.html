<!DOCTYPE html>
<!--
==========================================================================
Generated on Fri Oct 28 2016 13:20:14 GMT+0100 (BST)
Description: D3.js-v3 colour coded tree diagram with 'flat' data
Version: v0.0.1
Contributors: Dawn Ahukanna (https://github.com/dahukanna)

Notice:
Do NOT edit this file below this point, any changes will be overwritten.
==========================================================================
-->
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Project Repos</title>
    <style>
      h1
      {
        margin: 1em auto;
        width: 80%;
        min-width: 9em;
        text-align: center;
      }

      .link
      {
        fill: none;
        stroke: #ccc;
        stroke-width: 2px;
      }

      .node circle,
      .node-L00 circle,
      .node-L1 circle,
      .node-L10 circle,
      .node-L20 circle,
      .node-L30 circle, .node-L31 circle, .node-L32 circle, .node-L33 circle,
      .node-L40 circle,
      .node-L50 circle
      {
        stroke-width: 3px;
      }
    	.node-L00 circle
      {
    	  fill: rgba(65, 120, 190, 1);
    	  stroke: rgba(65, 120, 190, 1);
    	}

      .node-L1 circle
      {
    	  fill: rgba(65, 120, 190, 0.5);
    	  stroke: rgba(65, 120, 190, 1);
    	}

      .node-L10 circle
      {
    	  fill: rgba( 30, 129, 140, 0.5);
    	  stroke: rgba( 30, 129, 140, 1);
    	}

      .node-L20 circle
      {
    	  fill: rgba( 75, 132, 0, 0.5);
    	  stroke: rgba( 75, 132, 0, 1);
    	}

      .node-L30 circle
      {
    	  fill: rgba(253, 214, 0, 0.5);
    	  stroke: rgba(253, 214, 0, 1);
    	}

      .node-L31 circle
      {
    	  fill: rgba(239, 193, 0, 0.5);
    	  stroke: rgba(239, 193, 0, 1);
    	}

      .node-L32 circle
      {
    	  fill: rgba(190, 155, 0, 0.5);
    	  stroke: rgba(190, 155, 0, 1);
    	}

      .node-L33 circle
      {
    	  fill: rgba(140, 115, 0, 0.5);
    	  stroke: rgba(140, 115, 0, 1);
    	}

      .node-L40 circle
      {
    	  fill: rgba(215, 65, 8, 0.5);
    	  stroke: rgba(215, 65, 8, 1);
    	}

      .node-L50 circle
      {
        fill: rgba(152, 85, 212, 0.5);
        stroke: rgba(152, 85, 212, 1);
      }

    	.node text,
      .node-L00 text,
      .node-L1 text,
      .node-L10 text,
      .node-L20 text,
      .node-L30 text, .node-L31 text, .node-L32 text, .node-L33 text,
      .node-L40 text,
      .node-L50 text
      {
        font: 12px sans-serif;
      }

      .emphasis circle:hover
      {
        cursor: pointer;
        opacity: 0.5;
        -webkit-transform: scale(1.3);
        -ms-transform: scale(1.3);
        transform: scale(1.3);
      }

    </style>
  </head>

  <body>
    <h1> GitHub Repo Universe </h1>
    <p> Click on filled circles to open new tab/window to the GitHub Repository </p>
    <!-- load the d3.js library -->
    <script src="https://d3js.org/d3.v3.min.js"></script>
    <script>
      var data =
      [
        { "name" : "Github", "parent":"null"},
          { "name" : "User Repository", "parent":"Github", "level":10, "link":"https://github.com/dahukanna/dahukanna.github.io" },
          { "name" : "Issues", "parent":"Github", "level":20, "link":"https://github.com/dahukanna/dahukanna.github.io/issues" },
          { "name" : "Project Repositories", "parent":"Github", "level":30 },
            { "name" : "Presentations", "parent":"Project Repositories", "level":31 },
              { "name" : "Install Dabblet", "parent":"Presentations", "level":31, "link":"https://github.com/dahukanna/pr-installDabblet" },
              {"name" : "Setup Gitbook", "parent":"Presentations", "level":31, "link":"https://dahukanna.github.io/pr-standaloneGitbook/" },

            { "name" : "Talks", "parent":"Project Repositories", "level":32 },
              { "name" : "It's Cognitive", "parent":"Talks", "level":32, "link":"https://dahukanna.github.io/pr-itscognitive" },

            { "name" : "Samples", "parent":"Project Repositories", "level":33 },
              { "name" : "Deploy to Bluemix", "parent":"Samples", "level":33, "link":"https://github.com/dahukanna/deployToBluemix" }
      ];

      // *********** Convert flat data into a nice tree ***************
      // create a name: node map
      var dataMap = data.reduce(function(map, node) {
      	map[node.name] = node;
      	return map;
      }, {});

      // create the tree array
      var treeData = [];
      data.forEach(function(node) {
      	// add to parent
      	var parent = dataMap[node.parent];
      	if (parent) {
      		// create child array if it doesn't exist
      		(parent.children || (parent.children = []))
      			// add node to child array
      			.push(node);
      	} else {
      		// parent is null or missing
      		treeData.push(node);
      	}
      });

      // ************** Generate the tree diagram	 *****************
      var margin = {top: 50, right: 120, bottom: 20, left: 120},
      	width = 960 - margin.right - margin.left,
      	height = 500 - margin.top - margin.bottom;

      var i = 0;

      var tree = d3.layout.tree()
      	.size([height, width]);

      var diagonal = d3.svg.diagonal()
      	.projection(function(d) { return [d.y, d.x]; });

      var svg = d3.select("body").append("svg")
      	.attr("width", width + margin.right + margin.left)
      	.attr("height", height + margin.top + margin.bottom)
        .append("g")
      	.attr("transform", "translate(" + margin.left + "," + margin.top + ")");

      root = treeData[0];

      update(root);

      function update(source) {

        // Compute the new tree layout.
        var nodes = tree.nodes(root).reverse(),
      	  links = tree.links(nodes);

        // Normalize for fixed-depth.
        nodes.forEach(function(d) { d.y = d.depth * 180; });

        // Declare the nodes…
        var node = svg.selectAll("g.node")
      	  .data(nodes, function(d) { return d.id || (d.id = ++i); });

        // Enter the nodes.
        var nodeEnter = node.enter().append("g")
      	  // .attr("class", "node-L0")
          //.attr("class", function(d) { return d.level ? "node-L"+ d.level : "node-L00"; })
          .attr("class", getCircleClasses)
      	  .attr("transform", function(d) {
      		  return "translate(" + d.y + "," + d.x + ")"; })
          .on("click", click);

          nodeEnter.append("circle")
          .attr("r", 10)
          //.style("fill", "#fff");
          .style("fill", function(d) { return d.children || d._children ? "#fff" : ""; });

        nodeEnter.append("text")
      	  .attr("x", function(d) {
      		  return d.children || d._children ? -13 : 13; })
      	  .attr("dy", ".35em")
      	  .attr("text-anchor", function(d) {
      		  return d.children || d._children ? "end" : "start"; })
      	  .text(function(d) { return d.name; })
      	  .style("fill-opacity", 1);

        // Declare the links…
        var link = svg.selectAll("path.link")
      	  .data(links, function(d) { return d.target.id; });

        // Enter the links.
        link.enter().insert("path", "g")
      	  .attr("class", "link")
          //.attr("class", getLinkClasses)
      	  .attr("d", diagonal);
      }

      // Open URL in new window or tab
      function click(d)
      {
        if (d.link)
        {
          myWindow = window.open(d.link, "_blank");   // Opens a new window
        }
      }

      // Generate class string
      function getCircleClasses(d)
      {
        var classes = "node-L00";
        if (d.level)
        {
          classes = "node-L"+ d.level;  //Set specific class for the node position.
        }
        if (d.link)
        {
          classes += " emphasis";  //Set hover class for circle.
        }

        return classes;
      }

    </script>

  </body>
</html>
